## å¾®ä¿¡å°ç¨‹åºæŠ“åŒ…å’Œè§£åŒ…

----

> è¿™é‡Œä¸»è¦ä½¿ç”¨çš„å·¥å…·æ˜¯
>
> - Proxifier
> - Yakit

### ä»£ç† é…ç½®

åœ¨Proxifierä¸­

å…ˆæ·»åŠ ä¸€ä¸ªä»£ç†ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯3333ç«¯å£

![image-20241130131722799](https://gitee.com/bx33661/image/raw/master/path/image-20241130131722799.png)

åœ¨yakitä¸­

åœ¨MITMäº¤äº’åŠ«æŒä¸­æ·»åŠ 3333åŠ«æŒ

![image-20241130131944630](https://gitee.com/bx33661/image/raw/master/path/image-20241130131944630.png)

è¿™ä¸ªåé¢å°±æ˜¯å®‰è£…è¯ä¹¦

![image-20241130132037314](https://gitee.com/bx33661/image/raw/master/path/image-20241130132037314.png)

ä»£ç†è§„åˆ™é…ç½®

- å¯ä»¥ç›´æ¥ä¸‹è½½yakité…ç½®å¥½çš„è§„åˆ™ï¼Œç›´æ¥å¯¼å…¥Prox

https://aliyun-oss.yaklang.com/utils/Yakit-WeChatAppEx.ppx

- è‡ªå·±æ‰‹åŠ¨æ·»åŠ 

åœ¨Ruleé¡µé¢æ·»åŠ ï¼Œä¿å­˜

![image-20241130132207621](https://gitee.com/bx33661/image/raw/master/path/image-20241130132207621.png)



### å¼€å§‹æŠ“åŒ…

> å¦‚æœå‰é¢é…ç½®å¥½äº†ï¼Œä½†æ˜¯æ— æ³•æŠ“åŒ…ï¼Œå¯ä»¥çœ‹ä¸€è¿™ä¸ªé”™è¯¯æ’æŸ¥
>
> https://yaklang.com/Yaklab/WeChatAppEx/#%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E6%8E%92%E6%9F%A5

![image-20241130132328064](https://gitee.com/bx33661/image/raw/master/path/image-20241130132328064.png)

è¿™é‡Œèµ°å°ç¨‹åºçš„æµé‡æˆ‘ä»¬å°±å¯ä»¥åœ¨Yakitä¸­æ‰¾åˆ°äº†



### å°ç¨‹åºä¸€äº›ä¿¡æ¯è·å–

è¿›å…¥è¿™ä¸ªå°ç¨‹åºé¡µé¢å³ä¸Šè§’ä¸‰ä¸ªç‚¹

![image-20241130133127867](https://gitee.com/bx33661/image/raw/master/path/image-20241130133127867.png)

å¯ä»¥çœ‹åˆ°ä¸€äº›å°ç¨‹åºå¼€å‘å¸¸è§ä¿¡æ¯

<img src="https://gitee.com/bx33661/image/raw/master/path/c6a2a0fb8431b7e99d19b756537fa16.jpg" alt="c6a2a0fb8431b7e99d19b756537fa16" style="zoom:50%;" />

### ä¸€ä¸ªç®€å•çš„åˆ©ç”¨

éšä¾¿æ‰¾äº†ä¸€ä¸ªå°ç¨‹åº----å½©è™¹å¿—æ„¿ï¼ˆå€’éœ‰ğŸ¥šï¼‰

![image-20241130135722415](https://gitee.com/bx33661/image/raw/master/path/image-20241130135722415.png)



![image-20241130140054906](https://gitee.com/bx33661/image/raw/master/path/image-20241130140054906.png)

åœ¨yakitä¸­æ‰¾åˆ°ä»–çš„apiæ•°æ®

![image-20241130135811921](https://gitee.com/bx33661/image/raw/master/path/image-20241130135811921.png)

è®¿é—®ä¸€ä¸‹çœ‹çœ‹ï¼šhttps://api.caihongzhiyuan.cn/api_front/college/45?

![image-20241130135836494](https://gitee.com/bx33661/image/raw/master/path/image-20241130135836494.png)

å…¨æ˜¯é¡µé¢çš„æ•°æ®

å†™äº†ä¸€ä¸ªå¤„ç†çˆ¬å–çš„è„šæœ¬

```python
import json
import csv
import requests

def extract_school_info(json_data):
    # æå–å­¦æ ¡åç§°
    school_name = json_data['college']['name']
    
    # æå–å­¦æ ¡åœ°å€
    school_address = json_data['college']['attach']['address']
    
    # æå–å­¦æ ¡ç®€ä»‹
    school_introduce = json_data['college']['attach']['introduce']
    
    # æå–å­¦æ ¡ç”µè¯
    school_telephone = json_data['college']['attach']['telephone']
    
    # æå–å­¦æ ¡ç½‘ç«™
    school_website = json_data['college']['attach']['website']
    
    # æå–å­¦æ ¡æ‰€å±çœä»½
    school_province = json_data['college']['province']['name']
    
    # æå–å­¦æ ¡æ‰€å±åŸå¸‚
    school_city = json_data['college']['city']['name']
    
    # æå–å­¦æ ¡ç±»å‹
    school_type = json_data['college']['type']['name']
    
    # æå–å­¦æ ¡æ€§è´¨
    school_nature = json_data['college']['nature']['name']
    
    # æå–å­¦æ ¡æ ‡ç­¾
    school_tags = ', '.join([tag['name'] for tag in json_data['college']['tags']])
    
    # æå–å­¦æ ¡æ’åä¿¡æ¯
    school_ranks = []
    for rank in json_data['college']['attachRanks']:
        rank_info = {
            'rank': rank['rank'],
            'topRankType': rank['topRankType']['name'],
            'year': rank['year']
        }
        school_ranks.append(rank_info)
    
    return {
        'school_name': school_name,
        'school_address': school_address,
        'school_introduce': school_introduce,
        'school_telephone': school_telephone,
        'school_website': school_website,
        'school_province': school_province,
        'school_city': school_city,
        'school_type': school_type,
        'school_nature': school_nature,
        'school_tags': school_tags,
        'school_ranks': str(school_ranks)
    }

def fetch_and_save_school_info(start_id, end_id, csv_file_path):
    fieldnames = ['school_name', 'school_address', 'school_introduce', 'school_telephone', 
                  'school_website', 'school_province', 'school_city', 'school_type', 
                  'school_nature', 'school_tags', 'school_ranks']
    
    with open(csv_file_path, 'w', encoding='utf-8', newline='') as csvfile:
        writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
        writer.writeheader()
        
        for i in range(start_id, end_id + 1):
            url = f"https://api.caihongzhiyuan.cn/api_front/college/{i}"
            headers = {
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
            }
            response = requests.get(url, headers=headers)
            
            if response.status_code == 200:
                data = response.json()
                if 'college' in data:
                    school_info = extract_school_info(data)
                    writer.writerow(school_info)
                else:
                    print(f"No college data found for ID {i}")
            else:
                print(f"Failed to fetch data for ID {i}, status code: {response.status_code}")

# ä½¿ç”¨ç¤ºä¾‹
fetch_and_save_school_info(1, 100, 'å­¦æ ¡/æ‰€æœ‰å­¦æ ¡ä¿¡æ¯.csv')
```

æœ€åç»“æœ

![image-20241130135947916](https://gitee.com/bx33661/image/raw/master/path/image-20241130135947916.png)

æœ€åæŠŠcsvæ•°æ®å¯¼å…¥excelä¸­

![image-20241130135616555](https://gitee.com/bx33661/image/raw/master/path/image-20241130135616555.png)





### å¾®ä¿¡å°ç¨‹åºé€†å‘è§£åŒ…

> ä½¿ç”¨å·¥å…·ï¼š
>
> [UnpackMiniApp/UnpackMiniApp.exe at main Â· Angels-Ray/UnpackMiniApp Â· GitHub](https://github.com/Angels-Ray/UnpackMiniApp/blob/main/UnpackMiniApp.exe)

è·å–å°ç¨‹åºæ–‡ä»¶

1.é¦–å…ˆè¿›å…¥è¿™ä¸ªæ–‡ä»¶ç®¡ç†ç›®å½•

![image-20241130142144309](https://gitee.com/bx33661/image/raw/master/path/image-20241130142144309.png)

2. è¿›å…¥å°ç¨‹åºæ–‡ä»¶ä½ç½®

![image-20241130142249118](https://gitee.com/bx33661/image/raw/master/path/image-20241130142249118.png)

å¯ä»¥çœ‹åˆ°è¿™ä¸ª

![image-20241130142309627](https://gitee.com/bx33661/image/raw/master/path/image-20241130142309627.png)

æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªä¸€é”®è§£å¯†å·¥å…·å¯ä»¥

![image-20241130140905490](https://gitee.com/bx33661/image/raw/master/path/image-20241130140905490.png)

> æ³¨æ„âš ï¸è¿™ä¸ªä¸‹è½½åéœ€è¦ç»™å®ƒåˆ›å»ºä¸€ä¸ªwxpackæ–‡ä»¶å¤¹

å¯ä»¥å¾—åˆ°è¿™ä¸ª

![image-20241130142421414](https://gitee.com/bx33661/image/raw/master/path/image-20241130142421414.png)

[GitHub - Angels-Ray/wxappUnpacker: åŸºäºnodeåç¼–è¯‘å°ç¨‹åº å·²ç»é…ç½®å®Œæˆ](https://github.com/Angels-Ray/wxappUnpacker)

åˆ©ç”¨ä¸Šé¢è¿™ä¸ªå·¥å…·

- é¦–å…ˆè¦æœ‰nodeç¯å¢ƒ

- ```bash
  git clone https://github.com/Angels-Ray/wxappUnpacker.git
  cd wxappUnpacker
  ```

- ```bash
  #ä¸€é”®å®‰è£…
  npm install
  
  #æˆ–è€…
  npm install esprima
  npm install css-tree
  npm install cssbeautify
  npm install vm2
  npm install uglify-es
  npm install js-beautify
  ```

![image-20241130142637037](https://gitee.com/bx33661/image/raw/master/path/image-20241130142637037.png)

è¿™æ ·å°±OKäº†

```bash
./bingo.bat D:\downloads\unpack\wxpack\wxbffcc9a1dff2dc6f.wxapkg
```

![image-20241130142655214](https://gitee.com/bx33661/image/raw/master/path/image-20241130142655214.png)

å¯ä»¥çœ‹åˆ°è§£åŒ…åçš„ç›®å½•ï¼š
![image-20241130142749395](https://gitee.com/bx33661/image/raw/master/path/image-20241130142749395.png)

å¯ä»¥ä½¿ç”¨è¿™ä¸ªå°ç¨‹åºå¼€å‘å·¥å…·æ‰“å¼€æ–‡ä»¶å¤¹

![image-20241130142114054](https://gitee.com/bx33661/image/raw/master/path/image-20241130142114054.png)



è¿™ä¸ªä¸€èˆ¬æ˜¯ç”¨äºåˆ†æåŠ å¯†è§„åˆ™çš„ï¼Œè¿˜æ²¡æœ‰æ‰¾åˆ°å¥½çš„ä¾‹å­ï¼Œåé¢è¡¥å……